<html lang="en">

<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
    <script src="https://cdn.kustomerapp.com/card-js/latest/kustomer-card.min.js"></script>
    <script>
        function loadContext() {
            // Kustomer.initialize is required for card visibility in the panel.
            Kustomer.initialize(function (contextJSON) {
                console.log(contextJSON)
                var template = $("#mp_template").html();
                $("#panel").html(Mustache.render(template, contextJSON));
                let timerID = setInterval(function(){
                    getTimer()
                }, 5000);
                Kustomer.resize();
            });

        }
        async function getTimer()
        {
                    console.log("calling timer api")
                    const res = await fetch('https://worldtimeapi.org/api/timezone/Asia/Dhaka');
                    console.log("res",res.json().body)
                    $("#timer").text(res.body.datetime)
        }
    </script>
</head>

<body onload="loadContext()">
    <h6>Order Details</h6>
    <script id="mp_template" type="text/template">
<div class="container">
  <div class="row">
    <div class="col ">
        <label class="col-sm-3">Order #</label>
        <label >{{order.properties.order_id}}</label>
    </div>
    <div class="col ">
        <label class="col-sm-3">Status</label>
        <label >{{order.event}}</label>
    </div>
   <div class="col ">
        <label class="col-sm-3">Timer</label>
        <label  id="timer" >{{order.event}}</label>
    </div>
  </div>
  <div class="row">
    <div class="col ">
        <label class="col-sm-3" >Cart Amount</label>
        <label class="col-sm-9">{{order.properties.cart_amount}}</label>
    </div>
    <div class="col">
        <label class="col-sm-3">Currency</label>
        <label class="col-sm-9">{{order.properties.currency}}</label>
    </div>
  </div>
  <div class="row">
    <div class="col ">  
        <label class="col-sm-3" for="staticEmail" >Products</label>
        {{#order.properties.product_name}}
        <label class="col-sm-9" for="staticEmail" >{{.}}</label> </br>
        {{/order.properties.product_name}}
    </div>
    <div class="col">
        <label class="col-sm-3" for="staticEmail" >Qty</label>
        {{#order.properties.product_quantity}}
        <label class="col-sm-9" for="staticEmail" >{{.}}</label></br>
        {{/order.properties.product_quantity}}
    </div>
    <div class="col">
        <label class="col-sm-3" for="staticEmail" >Prize</label>
        {{#order.properties.product_price}}
        <label class="col-sm-9" for="staticEmail" >{{.}}</label></br>
        {{/order.properties.product_price}}
    </div>
  </div>
  <div class="row">
    <div class="col ">  
    </div>
    <div class="col ">  
        <button type="button" class="btn btn-primary">Cancel Order</button>
    </div>
    <div class="col ">  
        <button type="button" class="btn btn-secondary">Issue Refund</button>
    </div>
  </div>
</div>
</script>
    <div id="panel">

    </div>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mustache.js/2.3.0/mustache.min.js"></script>
</body>

</html>